<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>购物车</title>
<link rel="stylesheet" href="css/shopcar.css">
</head>
<body>
<!-- xstep_top -->
	<div class="xstep_top">
		<div class="step">
			<div class="hello">
				<h6>您好，欢迎光临特步官方商城！</h6>
			</div>
			<div id="welcomeBox">
				<p id="stuIdSpan"></p>
				<a id="quit" href="#">退出</a>
			</div>
			<div id="rl">
				<div class="reg">
					<a href="reg.html">注册</a>
				</div>
				<div class="log">
					<a href="log.html">登录</a>
				</div>
			</div>
		</div>
		<div class="myStep">
			<a href="#">我的特步</a>
			<a href="#">品牌官网</a>
			<a href="#">
				<img src="img/mobile_icon.png">
				<span>手机特步</span>
				<img src="img/mobile_scan.jpg">
				<img src="img/down_icon.png">
			</a>
			<a href="#">
				<img src="img/cart_icon.png">
				<span>
					<p>购物车</p>
					<p>(0)</p>
					<p>件</p>
				</span>
			</a>
		</div>
	</div>
<!-- header -->
	<div class="header">
		<div class="logo">
			<a href="#">
				<img src="img/logo1.jpg">
			</a>
		</div>
		<div class="search">
			<div class="up">
				<input type="text">
				<a href="#">搜索</a>		
			</div>
			<div class="down">
				<a href="#">热门搜索:</a>
				<a href="#">跑鞋</a>
				<a href="#">板鞋</a>
				<a href="#">21代风火鞋</a>
				<a href="#">动力巢x</a>
				<a href="#">明信同款</a>
			</div>
		</div>
		<div class="vip">
			<a id="photo" href="#">
				<img src="img/huiyuan.jpg">
				<img src="img/210-70.jpg">
			</a>
		</div>
	</div>
<!-- nav -->
	<ul class="nav">
		<li id="bad">
			<a id="good" href="#">全部商品分类</a>
			<div class="strate">
				<div class="man">
					<div class="man_top">
						<a href="#">男鞋</a>
					</div>
					<div class="content">
						<a href="#">跑步鞋</a>
						<a href="#">综训鞋</a>
						<a href="#">休闲鞋</a>
						<a href="#">板鞋</a>
						<a href="#">篮球鞋</a>
						<a href="#">足球鞋</a>
						<a href="#">棉鞋</a>
					</div>
				</div>
				<div class="man">
					<div class="man_top">
						<a href="#">女鞋</a>
					</div>
					<div class="content">
						<a href="#">跑步鞋</a>
						<a href="#">休闲鞋</a>
						<a href="#">板鞋</a>
						<a href="#">综训鞋</a>
						<a href="#">棉鞋</a>
					</div>
				</div>
				<div class="man">
					<div class="man_top">
						<a href="#">男装</a>
					</div>
					<div class="content">
						<a href="#">针织衫/卫衣/长T</a>
						<a href="#">长裤</a>
						<a href="#">风衣夹克</a>
						<a href="#">羽绒服</a>
						<a href="#">运动套装</a>
						<a href="#">运动T恤</a>
						<a href="#">休闲T恤</a>
						<a href="#">棉服</a>
						<a href="#">马甲</a>
						<a href="#">紧身裤</a>
					</div>
				</div>
				<div class="man">
					<div class="man_top">
						<a href="#">女装</a>
					</div>
					<div class="content">
						<a href="#">针织衫/卫衣/长T</a>
						<a href="#">长裤</a>
						<a href="#">风衣夹克</a>
						<a href="#">羽绒服/马甲</a>
						<a href="#">棉服</a>
						<a href="#">运动T恤</a>
						<a href="#">休闲T恤</a>
						<a href="#">短裤</a>
						<a href="#">运动套装</a>
						<a href="#">运动胸衣</a>
					</div>
				</div>
				<div class="man">
					<div class="man_top">
						<a href="#">童鞋</a>
					</div>
					<div class="content">
						<a href="#">跑步鞋</a>
						<a href="#">休闲鞋</a>
						<a href="#">板鞋</a>
						<a href="#">健康鞋</a>
						<a href="#">棉鞋</a>
					</div>
				</div>
				<div class="man">
					<div class="man_top">
						<a href="#">童装</a>
					</div>
					<div class="content">
						<a href="#">套装</a>
						<a href="#">羽绒服/棉服</a>
						<a href="#">外套/夹克</a>
						<a href="#">毛衣/卫衣/长袖T恤</a>
						<a href="#">长裤</a>
						<a href="#">短袖</a>
						<a href="#">短裤</a>
					</div>
				</div>
			</div>
		</li>
		<li class="lis">
			<a href="#">首页</a>
		</li>
		<li class="lis">
			<a href="#">跑步</a>
		</li>
		<li class="lis">
			<a href="#">男子</a>
		</li>
		<li class="lis">
			<a href="#">女子 </a>
		</li>
		<li class="lis">
			<a href="#">儿童</a>
		</li>
		<li class="lis">
			<a href="#">配件</a>
		</li>
		<li class="lis">
			<a href="#">马拉松</a>
		</li>
		<li class="lis">
			<a href="#">团购定制</a>
		</li>
	</ul>
<!-- slide -->
	<div class="slide">
		<a href="#">
			<img src="img/a1.jpg">
		</a>
		<a href="#">
			<img src="img/a2.jpg">
			<span>购<br/>物<br/>车</span>
			<span>0</span>
			<span>购物车</span>
		</a>
		<a href="#">
			<img src="img/a3.jpg">
			<span>联<br/>系<br/>客<br/>服</span>
			<img src="img/20185231412596F6209274F2205DA89EC5D8526DA1558B.png">
			<img src="img/2018523142146733800F7071E793FDB31B43587EBC4B9AB.png">
			<img class="time" src="img/b1.jpg"/>
			<span>联系客服</span>
		</a>
		<a href="#">
			<img src="img/a4.jpg">
			<img src="img/sj.png">
			<img class="times" src="img/b1.jpg"/>
			<span>二维码</span>
		</a>
		<a href="#">
			<img src="img/a5.jpg">
			<span>TOP</span>
			<span>返回顶部</span>
			<span>顶部</span>
			<img class="tim" src="img/b1.jpg"/>
		</a>
	</div>
<!-- cat -->
	<div class="cat">
		<img src="img/Step-1.gif" alt="">
	</div>
<!-- mycar -->
	<div class="mycar">
		<div class="choose">
			<div class="duan">
				<p>我的购物车</p>
			</div>
			<div class="delete">
				<div class="checkall">
					<input id="box" type="checkbox"><span>全选</span>
					<p>商品</p>
					<p>市场价</p>
					<p>会员价</p>
					<p>数量</p>
					<p>赠送积分</p>
					<p>小计</p>
					<p>操作</p>
				</div>
				<div class="twice">
					<div class="road">
						<input id="fanXuan" type="checkbox">
						<span>反选</span>
						<img src="img/cha.jpg" alt="">
						<a href="javascript:;">批量删除</a>
					</div>
					<div class="trip">
						<div class="trip1">
							<p>3</p>
							<p>件商品</p>
						</div>
						<div class="trip2">
							<p>支付积分：0</p>
							<p>赠送积分：<span>847</span></p>
							<p>缴纳税费：0</p>
						</div>
					</div>
				</div>
				<!-- <div class="total">
					<p>
						<span>总计(不含运费)</span>
						<span>￥897.00</span>
					</p>
					<p>已节省-￥0.00</p>
				</div> -->
				<div class="continues">
					<div class="go">
						<a href="shoplist.html">继续购物</a>
						<a href="#">去结算</a>
					</div>
					<div class="super">
						<h3>超值特惠</h3>
						<div class="stocks">
							<div class="stock">
								<img class="ku" src="img/20181218161045168FC0E908D5CBC17AD7D99864563CC08CA.jpg" alt="">
								<div class="upBox">
									<a href="#">
										<span>特步  男子秋季时尚百搭 &nbsp;新款长裤982319319072</span>
										<span>会员价：￥279.00</span>
										<span>￥419.00</span>
										<span>
											加入购物车
											<img src="img/wh.jpg" alt="">
										</span>
									</a>
								</div>
							</div>
							<div class="stock">
								<img class="ku" src="img/20181218161045168FC0E908D5CBC17AD7D99864563CC08CA.jpg" alt="">
								<div class="upBox">
									<a href="#">
										<span>特步  男子秋季时尚百搭 &nbsp;新款长裤982319319072</span>
										<span>会员价：￥279.00</span>
										<span>￥419.00</span>
										<span>
											加入购物车
											<img src="img/wh.jpg" alt="">
										</span>
									</a>
								</div>
							</div>
							<div class="stock">
								<img class="ku" src="img/20181218161045168FC0E908D5CBC17AD7D99864563CC08CA.jpg" alt="">
								<div class="upBox">
									<a href="#">
										<span>特步  男子秋季时尚百搭 &nbsp;新款长裤982319319072</span>
										<span>会员价：￥279.00</span>
										<span>￥419.00</span>
										<span>
											加入购物车
											<img src="img/wh.jpg" alt="">
										</span>
									</a>
								</div>
							</div>
							<div class="stock">
								<img class="ku" src="img/20181218161045168FC0E908D5CBC17AD7D99864563CC08CA.jpg" alt="">
								<div class="upBox">
									<a href="#">
										<span>特步  男子秋季时尚百搭 &nbsp;新款长裤982319319072</span>
										<span>会员价：￥279.00</span>
										<span>￥419.00</span>
										<span>
											加入购物车
											<img src="img/wh.jpg" alt="">
										</span>
									</a>
								</div>
							</div>
							<div class="stock">
								<img class="ku" src="img/20181218161045168FC0E908D5CBC17AD7D99864563CC08CA.jpg" alt="">
								<div class="upBox">
									<a href="#">
										<span>特步  男子秋季时尚百搭 &nbsp;新款长裤982319319072</span>
										<span>会员价：￥279.00</span>
										<span>￥419.00</span>
										<span>
											加入购物车
											<img src="img/wh.jpg" alt="">
										</span>
									</a>
								</div>
							</div>
							<div class="stock">
								<img class="ku" src="img/20181218161045168FC0E908D5CBC17AD7D99864563CC08CA.jpg" alt="">
								<div class="upBox">
									<a href="#">
										<span>特步  男子秋季时尚百搭 &nbsp;新款长裤982319319072</span>
										<span>会员价：￥279.00</span>
										<span>￥419.00</span>
										<span>
											加入购物车
											<img src="img/wh.jpg" alt="">
										</span>
									</a>
								</div>
							</div>
						</div>
					</div>
					<div class="super">
						<h3>购买过上述宝贝的人还购买过</h3>
						<div class="stocks">
							<div class="stock">
								<img class="ku" src="img/20181218161045168FC0E908D5CBC17AD7D99864563CC08CA.jpg" alt="">
								<div class="upBox">
									<a href="#">
										<span>特步  男子秋季时尚百搭 &nbsp;新款长裤982319319072</span>
										<span>会员价：￥279.00</span>
										<span>￥419.00</span>
										<span>
											加入购物车
											<img src="img/wh.jpg" alt="">
										</span>
									</a>
								</div>
							</div>
							<div class="stock">
								<img class="ku" src="img/20181218161045168FC0E908D5CBC17AD7D99864563CC08CA.jpg" alt="">
								<div class="upBox">
									<a href="#">
										<span>特步  男子秋季时尚百搭 &nbsp;新款长裤982319319072</span>
										<span>会员价：￥279.00</span>
										<span>￥419.00</span>
										<span>
											加入购物车
											<img src="img/wh.jpg" alt="">
										</span>
									</a>
								</div>
							</div>
							<div class="stock">
								<img class="ku" src="img/20181218161045168FC0E908D5CBC17AD7D99864563CC08CA.jpg" alt="">
								<div class="upBox">
									<a href="#">
										<span>特步  男子秋季时尚百搭 &nbsp;新款长裤982319319072</span>
										<span>会员价：￥279.00</span>
										<span>￥419.00</span>
										<span>
											加入购物车
											<img src="img/wh.jpg" alt="">
										</span>
									</a>
								</div>
							</div>
							<div class="stock">
								<img class="ku" src="img/20181218161045168FC0E908D5CBC17AD7D99864563CC08CA.jpg" alt="">
								<div class="upBox">
									<a href="#">
										<span>特步  男子秋季时尚百搭 &nbsp;新款长裤982319319072</span>
										<span>会员价：￥279.00</span>
										<span>￥419.00</span>
										<span>
											加入购物车
											<img src="img/wh.jpg" alt="">
										</span>
									</a>
								</div>
							</div>
							<div class="stock">
								<img class="ku" src="img/20181218161045168FC0E908D5CBC17AD7D99864563CC08CA.jpg" alt="">
								<div class="upBox">
									<a href="#">
										<span>特步  男子秋季时尚百搭 &nbsp;新款长裤982319319072</span>
										<span>会员价：￥279.00</span>
										<span>￥419.00</span>
										<span>
											加入购物车
											<img src="img/wh.jpg" alt="">
										</span>
									</a>
								</div>
							</div>
							<div class="stock">
								<img class="ku" src="img/20181218161045168FC0E908D5CBC17AD7D99864563CC08CA.jpg" alt="">
								<div class="upBox">
									<a href="#">
										<span>特步  男子秋季时尚百搭 &nbsp;新款长裤982319319072</span>
										<span>会员价：￥279.00</span>
										<span>￥419.00</span>
										<span>
											加入购物车
											<img src="img/wh.jpg" alt="">
										</span>
									</a>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
<!-- about -->
	<div class="about">
		<div class="mine">
			<div class="info">
				<h3>关于我们</h3>
				<a href="#">公司简介</a>
				<a href="#">联系我们</a>
			</div>
			<div class="info">
				<h3>购物指南</h3>
				<a href="#">常见问题</a>
				<a href="#">用户注册</a>
				<a href="#">购物流程</a>
			</div>
			<div class="info">
				<h3>售后服务</h3>
				<a href="#">配送方式</a>
				<a href="#">防伪查询</a>
				<a href="#">发票制度</a>
			</div>
			<div class="line">
				<h3>400-008-7666</h3>
				<p>周一至周日 8:30-21:30</p>
				<a href="#">
					<img src="img/v1.jpg">
					<span>在线客服</span>
				</a>
				<p>周一至周日 9:00-23:00</p>
			</div>
		</div>
	</div>
<!-- foot -->
	<div class="foot">
		<img src="img/x-footer.jpg"/>
	</div>
<!-- foots -->
	<div class="foots">
		<div class="pay">
			<div class="ment">
				<a href="#">关于特步</a>
				<a href="#">帮助中心</a>
				<a href="#">友情联接</a>
				<a href="#">联系我们</a>
			</div>
			<div class="reserved">
				<p>特步跑鞋 Copyright 2011 xtep.com 特步运动服 All Rights Reserved 特步官方旗舰店 ICP：闽ICP备05021253号-1 特步官网专卖店</p>
			</div>
			<div class="ready">
				<a href="#">
					<img src="img/1234.png"/>
					<span>闽公网安备 35020302001628号</span>
				</a>
			</div>
		</div>
	</div>
<!-- footer -->
	<div class="footer">
		<img src="img/onlinepay.jpg">
		<a href="#">
			<img src="img/goodwebsite.jpg">
		</a>
		<a href="#">
			<img src="img/salf.jpg">
		</a>
		<a href="#">
			<img src="img/ei_normal.png">
		</a>
	</div>
</body>
</html>
<script type="text/javascript" src="js/cookieTools.js"></script>
<script type="text/javascript" src="js/jquery-1.8.3.js"></script>
<script type="text/javascript">
var name =getCookie("username");
   
   $(function(){		
   		$("#quit").click(function(){
			removeCookie("username");
			$("#stuIdSpan").html(null);
			$("#welcomeBox").css("display","none");
			$("#rl").css("display","flex");
		});
		// console.log(name);
		if(name!=null){
			$("#stuIdSpan").html(name);
			$("#welcomeBox").css("display","flex");
			$("#rl").css("display","none");
		};
   		$.ajax({
   			type:"get",
   			url:"getShoppingCart.php",
   			data:{vipname:name},
   			datatype:"json",
   			async:false,
   			success:function(data){
   				// console.log(data);
   				var  obj=JSON.parse(data);
   				// console.log(obj.goodsImg);
   				var ids;
   				var str="";
   				$.each(obj,function(idx,val){
   					ids=val.goodsId;
   					console.log(ids);
   					str+=`
						 <div class="pause">
					<div class="where">
						<input type="checkbox">
						<img src="${val.goodsImg}">
					</div>
					<div class="slow">
						<a href="#">${val.goodsDesc}</a>
						<p>颜色:黑 尺码:41码</p>
					</div>
					<div class="have">
						<p>￥419.00</p>
						<p>￥${val.goodsPrice}</p>
						<div class="mile">
							<span class="min">-</span>
							<span class="quantity">${val.goodsCount}</span>
							<span class="adds">+</span>
						</div>
						<p>${val.goodsPrice-10}</p>
						<p class="xiaoji">${(val.goodsPrice*val.goodsCount).toFixed(2)}</p>
						<a href="javascript:;">删除</a>
					</div>
				</div>
				
   					`
   				
   				});
   				$(str).insertBefore(".twice");

   				//商品数量加减
   				$(".adds").click(function(){
				var num=parseInt($(this).prev().text());
				var domObj=$(this);
				num+=1;
				$(this).prev().text(num);
				loadCart(domObj);
			});
			$(".min").click(function(){
				var count=parseInt($(this).next().text());
				count-=1;
				if(count<=0){
					return;
				}
				$(this).next().text(count);
				loadCart();
				
			})
   				//删除
   				$(".have a:last-child").click(function(){
				$(this).parent().parent().remove();
				});


				//总计函数
		        // function totle(){
		        //     var sum = 0 ;

		        //     $('.xiaoji').each(function(){
		        //         sum +=parseInt($(this).text());
		        //     });
		        //     $('#money').text(sum);
		        // }

				//全选与反选框
				jQuery.fn.extend({
				checked:function(isChecked){
					//this是checked函数隶属的对象
					this.each(function(){
						this.checked = isChecked;
					});
				},
				unchecked:function(){
					this.each(function(){
						this.checked = !this.checked;
					});
				},
				guanlianCheck:function($child){
					let $parent = this;
					// console.log($parent);
					//1、子控制父的选择
					$(".pause .where input").click(function(){
						let allCheck = true;
						//1）、循环所有的子chckbox，
						$(".pause .where input").each(function(){
							if(!this.checked){
								allCheck = false;
							}
						});
						$parent[0].checked = allCheck;
					});
					//2、父控制子的选择
					//this：调用此函数的对象（jQuery对象），
					$("#box").click(function(){
						let parent = this;//此this是事件源，是DOM对象
						// console.log(parent);
						$(".pause .where input").each(function(){
							//此this是$child里的每一个DOM元素；
							this.checked =parent.checked; 
						});
					});	
				}
			});
					$("#fanXuan").click(function(){
						$(".pause .where input").unchecked();
						// $("#box").unchecked();
					});
					
					$("#box").guanlianCheck($(".pause .where").children("input:checkbox"));


					function loadCart(domObj){
					var countes=parseInt(domObj.prev().text());
							$.ajax({
				   			type:"get",
				   			url:"updateGoodsCount.php",
				   			datas:{vipname:name,goodsId:ids,goodsCount:countes},
				   			async:false,
				   			success:function(datas){
				   				alert("1");
				   			},error:function(){
				   				alert("0");
				   			}
				   		})
					}
					
   			}

   		})




   		  	var html="";
   			html+=`
   				<div class="total">
					<p>
						<span id="money">总计(不含运费)</span>
						<span>￥897.00</span>
					</p>
					<p>已节省-￥0.00</p>
				</div>`
   			$(html).insertAfter(".twice");
   });

	//批量删除
	$(function(){
		
		$(".road a:last-child").click(function(){
			if($(".pause .where input:checked")){
				$(".pause .where input:checked").parent().parent().remove();
			}
		})
	})
   



</script>